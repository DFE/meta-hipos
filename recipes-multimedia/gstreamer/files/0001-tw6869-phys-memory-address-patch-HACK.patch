From 6df174e9ca17b17dc169149ec86783c6d864a7e2 Mon Sep 17 00:00:00 2001
From: Sascha Dierberg <dierberg@bfg9000.internal.dresearch-fe.de>
Date: Mon, 18 Jan 2016 15:10:27 +0100
Subject: [PATCH] tw6869 phys memory address patch HACK

---
 src/v4l2src/v4l2_buffer_pool.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/src/v4l2src/v4l2_buffer_pool.c b/src/v4l2src/v4l2_buffer_pool.c
index 33b5aaa..ebeafea 100644
--- a/src/v4l2src/v4l2_buffer_pool.c
+++ b/src/v4l2src/v4l2_buffer_pool.c
@@ -176,10 +176,11 @@ static GstFlowReturn gst_imx_v4l2_buffer_pool_alloc_buffer(GstBufferPool *bpool,
 	}
 
 	phys_mem_meta = GST_IMX_PHYS_MEM_META_ADD(buf);
-	phys_mem_meta->phys_addr = meta->vbuffer.m.offset;
-
+	// SDG: Hack for tw6869
+	phys_mem_meta->phys_addr =  (*(__u32 *)meta->mem); // meta->vbuffer.m.offset;
+	
 	/* Safeguard to catch data loss if in any future i.MX version the types do not match */
-	g_assert(meta->vbuffer.m.offset == (__u32)(phys_mem_meta->phys_addr));
+	//g_assert(meta->vbuffer.m.offset == (__u32)(phys_mem_meta->phys_addr));
 
 	if (pool->add_videometa)
 	{
-- 
2.6.2

