From 23bdf1eac04a729f42a74ae73c4b8c26e7c0348f Mon Sep 17 00:00:00 2001
From: Mario Schuknecht <mario.schuknecht@dresearch-fe.de>
Date: Mon, 30 Jan 2017 14:28:01 +0100
Subject: [PATCH] ahci_imx: reset sata phy HYP-16664

Without additional IMX6Q reset the SATA link is down on dvrec MX6QP boards.

Signed-off-by: Mario Schuknecht <mario.schuknecht@dresearch-fe.de>
---
 drivers/ata/ahci_imx.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/drivers/ata/ahci_imx.c b/drivers/ata/ahci_imx.c
index 69422dc..6b2a90d 100644
--- a/drivers/ata/ahci_imx.c
+++ b/drivers/ata/ahci_imx.c
@@ -274,6 +274,11 @@ static int imx_sata_enable(struct ahci_host_priv *hpriv)
 		udelay(50);
 		regmap_update_bits(imxpriv->gpr, IOMUXC_GPR5,
 				   BIT(11), BIT(11));
+		/*
+		 * Without additional IMX6Q reset the SATA link is down on
+		 * dvrec MX6QP boards. MST 30.1.2017
+		 */
+		ret = imx_sata_phy_reset(hpriv);
 	}
 
 	if (ret) {
-- 
2.6.6

