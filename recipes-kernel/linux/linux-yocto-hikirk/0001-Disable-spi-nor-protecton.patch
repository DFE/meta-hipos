From e41ec12845285662732b21f973215fe7e9391fb0 Mon Sep 17 00:00:00 2001
From: Steffen Sledz <sledz@dresearch-fe.de>
Date: Wed, 20 Jan 2016 14:56:18 +0100
Subject: [PATCH] Disable spi nor protecton

Disable protection support, because it is used with not supported chip m25p80.

Signed-off-by: Mario Schuknecht <mario.schuknecht@dresearch-fe.de>
Signed-off-by: Steffen Sledz <sledz@dresearch-fe.de>
---
 drivers/mtd/spi-nor/spi-nor.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/drivers/mtd/spi-nor/spi-nor.c b/drivers/mtd/spi-nor/spi-nor.c
index d78831b..e32d143 100644
--- a/drivers/mtd/spi-nor/spi-nor.c
+++ b/drivers/mtd/spi-nor/spi-nor.c
@@ -1073,11 +1073,15 @@ int spi_nor_scan(struct spi_nor *nor, const char *name, enum read_mode mode)
 	mtd->_erase = spi_nor_erase;
 	mtd->_read = spi_nor_read;
 
+#if 0
+	/* Disable protection support, because it is used with
+	   not supported chips. */
 	/* nor protection support for STmicro chips */
 	if (JEDEC_MFR(info) == CFI_MFR_ST) {
 		nor->flash_lock = stm_lock;
 		nor->flash_unlock = stm_unlock;
 	}
+#endif
 
 	if (nor->flash_lock && nor->flash_unlock) {
 		mtd->_lock = spi_nor_lock;
-- 
2.7.0

